<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>家族旅遊工具（行程 + 報名 + 記帳）</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- PWA -->
  <link rel="manifest" href="manifest.json" />
  <link rel="apple-touch-icon" href="icons/icon.png" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="default" />
  <meta name="apple-mobile-web-app-title" content="家族旅遊" />

  <link rel="stylesheet" href="style.css" />
</head>

<body>
  <header class="topbar">
    <h1>家族旅遊工具</h1>
    <p class="subtitle">行程資訊 × 家族報名 × AA 分帳（多日制）</p>
  </header>

  <main class="container">

    <!-- ========================================================= -->
    <!-- 行程設定（主揪） -->
    <!-- ========================================================= -->
    <section class="card">
      <h2>基本行程資訊</h2>
      <form id="trip-form" class="form-grid">
        <label>
          旅遊名稱
          <input type="text" id="trip-title" placeholder="例如：2025 花東三天兩夜" required>
        </label>

        <label>
          日期
          <input type="text" id="trip-date" placeholder="例如：2025/04/03–04/05">
        </label>

        <label>
          集合地點
          <input type="text" id="trip-location" placeholder="例如：台北車站東三門">
        </label>

        <label class="full">
          行程簡介 / 備註
          <textarea id="trip-note" rows="2"></textarea>
        </label>

        <button type="submit" class="btn primary">儲存行程資訊</button>
      </form>

      <div class="info-box" id="trip-display"></div>
    </section>

    <!-- ========================================================= -->
    <!-- 家族成員報名 -->
    <!-- ========================================================= -->
    <section class="card">
      <h2>家族成員報名</h2>

      <form id="member-form" class="form-grid">

        <label>
          姓名
          <input type="text" id="member-name" required>
        </label>

        <label>
          代表人數
          <input type="number" id="member-count" value="1" min="1">
        </label>

        <label>
          顏色（行程顯示用）
          <input type="text" id="member-color" placeholder="#FF8800 或任何字串">
        </label>

        <label>
          電話
          <input type="text" id="member-phone">
        </label>

        <label class="full">
          飲食 / 備註
          <textarea id="member-note"></textarea>
        </label>

        <button type="submit" class="btn primary">加入成員</button>
      </form>

      <h3>成員列表</h3>
      <table class="table" id="member-table">
        <thead>
          <tr>
            <th>#</th><th>姓名</th><th>人數</th><th>顏色</th><th>電話</th><th>備註</th><th>操作</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
      <p id="total-members">總人數：0 人</p>
    </section>

    <!-- ========================================================= -->
    <!-- 多日行程（Day1、Day2...） -->
    <!-- ========================================================= -->
    <section class="card">
      <h2>行程（多日制）</h2>
      <p class="hint">主揪可以新增多天行程，每一天可以加入多個活動。下方彩色圓點 + 名字縮寫代表參加者。</p>

      <div class="form-grid">

        <label>
          天數
          <select id="day-select"></select>
        </label>

        <label>
          時間
          <input type="time" id="act-time">
        </label>

        <label>
          行程名稱
          <input type="text" id="act-title" placeholder="例如：早餐、海邊散步…">
        </label>

        <label>
          地點
          <input type="text" id="act-location" placeholder="地點名稱">
        </label>

        <label class="full">
          超連結（Google Maps）
          <input type="text" id="act-link" placeholder="https://maps.google.com/xxx">
        </label>

        <button id="add-activity" class="btn primary">加入行程</button>
        <button id="new-day" class="btn secondary">新增一天（Day）</button>
      </div>

      <div id="days-container"></div>
    </section>

    <!-- ========================================================= -->
    <!-- 記帳（AA 分帳） -->
    <!-- ========================================================= -->
    <section class="card">
      <h2>記帳（AA 自動分帳）</h2>

      <form id="expense-form" class="form-grid">

        <label>
          消費名稱
          <input type="text" id="exp-name" required>
        </label>

        <label>
          金額（NTD）
          <input type="number" id="exp-amount" required>
        </label>

        <label>
          付款人
          <select id="exp-payer"></select>
        </label>

        <label class="full">
          分帳成員
          <div id="exp-members" class="checkbox-container"></div>
        </label>

        <button type="submit" class="btn primary">加入記帳</button>
      </form>

      <h3>記帳紀錄</h3>
      <table class="table" id="expense-table">
        <thead><tr><th>項目</th><th>金額</th><th>付款人</th><th>分帳對象</th></tr></thead>
        <tbody></tbody>
      </table>

      <h3>結算結果</h3>
      <ul id="settlement-list" class="settlement"></ul>
    </section>

    <!-- ========================================================= -->
    <!-- 匯入匯出 -->
    <!-- ========================================================= -->
    <section class="card">
      <h2>資料管理</h2>

      <button id="export-json" class="btn small">匯出 JSON（備份）</button>

      <label class="btn small secondary">
        匯入 JSON
        <input type="file" id="import-json" accept="application/json" hidden>
      </label>

      <button id="clear-data" class="btn small danger">清空所有資料</button>
    </section>

  </main>

  <footer class="footer">
    <small>家族旅遊工具 · 純前端 · 支援離線（PWA）</small>
  </footer>

  <script src="app.js"></script>

  <!-- PWA -->
  <script>
    if ("serviceWorker" in navigator) {
      navigator.serviceWorker.register("service-worker.js");
    }
  </script>
</body>
</html>
